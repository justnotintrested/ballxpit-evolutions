<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ball x Pit Evolution Matrix</title>
<style>
  body { font-family: Arial, sans-serif; background:#111; color:#eee; padding:20px; }
  table { border-collapse: collapse; width: 100%; }
  th, td { border:1px solid #444; padding:6px; text-align:center; }
  th { background:#222; }
  td { background:#1a1a1a; cursor:pointer; }
  td:hover { background:#333; }

  .popup-bg {
    position: fixed; top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,0.7); display:none; justify-content:center; align-items:center;
  }
  .popup {
    background:#222; padding:20px; border-radius:10px; width:350px; text-align:center;
  }
  .popup img { width:80px; }
  .close { margin-top:15px; padding:8px 15px; background:#333; cursor:pointer; border-radius:5px; }
</style>
</head>
<body>

<h1>Ball x Pit Evolution Matrix</h1>
<div id="matrix"></div>

<div class="popup-bg" id="popbg">
  <div class="popup">
    <h2 id="pTitle"></h2>
    <img id="pImg" src="">
    <p id="pCombo"></p>
    <p id="pEffect"></p>
    <div class="close" onclick="document.getElementById('popbg').style.display='none'">Close</div>
  </div>
</div>

<script>
let baseBalls = [];
let evolutions = [];

Promise.all([
  fetch('base.json').then(r=>r.json()),
  fetch('evolutions.json').then(r=>r.json())
]).then(([base, evo]) => {
  baseBalls = base;
  evolutions = evo;
  buildMatrix();
});

function buildMatrix(){
  const names = baseBalls.map(x=>x.name);
  let html = `<table><tr><th></th>`;
  names.forEach(n => html += `<th><img src='${toFile(n)}' width='40'><br>${n}</th>`);
  html += `</tr>`;

  names.forEach(row =>{
    html += `<tr><th><img src='${toFile(row)}' width='40'><br>${row}</th>`;
    names.forEach(col =>{
      const found = evolutions.find(e=> e.row===row && e.col===col);
      if(found){
        html += `<td onclick='pop("${found.name}","${found.combo}","${found.effect}","${found.img}")'>
                   <img src='${found.img}' width='30'><br>${found.name}
                 </td>`;
      } else {
        html += `<td></td>`;
      }
    });
    html += `</tr>`;
  });

  html += `</table>`;
  document.getElementById('matrix').innerHTML = html;
}

function pop(title,combo,effect,img){
  document.getElementById('pTitle').innerText = title;
  document.getElementById('pCombo').innerText = combo;
  document.getElementById('pEffect').innerText = effect;
  document.getElementById('pImg').src = img;
  document.getElementById('popbg').style.display='flex';
}

function toFile(name){
  return name.toLowerCase().replace(/ /g,'_') + ".png";
}
</script>

</body>
</html>
