<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ball x Pit — Evolution Matrix (interactive)</title>
<style>
  :root{
    --bg:#111; --panel:#222; --muted:#1a1a1a; --text:#eee;
    --accent:#2ecc71; --warn:#f39c12; --border:#444;
  }
  .light {
    --bg:#fafafa; --panel:#fff; --muted:#f2f2f2;
    --text:#111; --accent:#0a7c3d; --warn:#b55a00; --border:#ddd;
  }

  body { background:var(--bg); color:var(--text); font-family:system-ui,Arial; margin:18px; }
  header { display:flex; gap:12px; align-items:center; justify-content:space-between; margin-bottom:12px; }
  h1{font-size:18px;margin:0}
  .controls { display:flex; gap:8px; align-items:center; }
  button { background:var(--panel); color:var(--text); border:1px solid var(--border);
           padding:8px 10px; border-radius:6px; cursor:pointer; }
  button:active{transform:translateY(1px)}
  .small { font-size:13px; padding:6px 8px; }

  /* MATRIX WRAPPER (fix) */
  .matrix-wrap {
    width: 100%;
    height: 80vh;
    overflow-x: auto;
    overflow-y: auto;
    border-radius: 8px;
    padding: 6px;
    background: var(--panel);
    border: 1px solid var(--border);
  }

  /* TABLE FIX */
  table {
    border-collapse: collapse;
    table-layout: fixed;
    width: max-content;     /* <— important: keeps full matrix visible */
    min-width: 100%;
  }

  th, td {
    border:1px solid var(--border);
    width:100px;            /* <— new size */
    height:100px;           /* <— new size */
    padding:4px;
    text-align:center;
    vertical-align:middle;
    overflow:hidden;
  }

  th { background:var(--panel); font-size:12px; }

  td {
    background:var(--muted);
    cursor:pointer;
    font-size:12px;
    transition:background .12s;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    gap:4px;
  }

  td.empty { background:transparent; cursor:default; }
  td.self { background:#666; color:#bbb; cursor:default; }

  td.evo-found {
    background: rgba(46,204,113,0.12);
    border-color: rgba(46,204,113,0.25);
  }
  td.evo-missing {
    background: rgba(243,156,18,0.08);
    border-color: rgba(243,156,18,0.18);
  }

  td img, th img {
    width:40px; height:40px; object-fit:contain;
    display:block; margin:0 auto;
  }

  /* Tooltip */
  #tooltip {
    position:fixed; pointer-events:none; display:none; z-index:9999;
    background:var(--panel); border:1px solid var(--border);
    padding:8px; border-radius:6px; width:220px;
    box-shadow:0 6px 18px rgba(0,0,0,.5);
  }
  #tooltip img { width:56px; height:56px; margin:0 auto 6px auto; }
  #tooltip h4 { margin:0 0 6px 0; font-size:14px; text-align:center; }
  #tooltip p { margin:0; font-size:12px; max-height:80px; overflow:auto; }

  /* Popup Modal */
  .modal-bg {
    position:fixed; inset:0; display:none;
    align-items:center; justify-content:center;
    background:rgba(0,0,0,0.6); z-index:10000;
  }
  .modal {
    background:var(--panel); padding:14px; border-radius:8px;
    width:360px; border:1px solid var(--border);
  }
  .modal h3{margin-top:0}
  .field{margin:8px 0; display:flex; flex-direction:column; gap:6px; }
  input[type="text"], textarea {
    padding:8px; border-radius:6px; border:1px solid var(--border);
    background:transparent; color:var(--text);
  }
  textarea{ min-height:80px; resize:vertical; }
  .row { display:flex; gap:8px; justify-content:flex-end; margin-top:8px; }
</style>
</head>
<body>

<header>
  <div>
    <h1>Ball x Pit — Evolution Matrix</h1>
    <div class="muted">Click a cell to view/edit. Hover for quick preview.</div>
  </div>

  <div class="controls">
    <button id="themeBtn" class="small">Toggle Theme</button>
    <button id="downloadBtn" class="small">Download evolutions.json</button>
    <button id="clearBtn" class="small">Reset (reload)</button>
  </div>
</header>

<div class="matrix-wrap">
  <div id="matrix"></div>
</div>

<!-- Tooltip -->
<div id="tooltip">
  <img id="ttImg">
  <h4 id="ttTitle"></h4>
  <p id="ttText"></p>
</div>

<!-- Modal -->
<div class="modal-bg" id="modalBg">
  <div class="modal">
    <h3>Edit Evolution</h3>

    <div class="field">
      <label>Row</label>
      <input id="inpRow" disabled>
    </div>

    <div class="field">
      <label>Column</label>
      <input id="inpCol" disabled>
    </div>

    <div class="field">
      <label>Name</label>
      <input id="inpName">
    </div>

    <div class="field">
      <label>Combo</label>
      <input id="inpCombo">
    </div>

    <div class="field">
      <label>Effect</label>
      <textarea id="inpEffect"></textarea>
    </div>

    <div class="field">
      <label>Image filename</label>
      <input id="inpImg">
    </div>

    <div class="row">
      <button id="delBtn" class="small">Delete</button>
      <button id="saveBtn" class="small">Save</button>
      <button id="cancelBtn" class="small">Cancel</button>
    </div>
  </div>
</div>

<script>
/* same JS you already have — unchanged */
</script>

</body>
</html>
